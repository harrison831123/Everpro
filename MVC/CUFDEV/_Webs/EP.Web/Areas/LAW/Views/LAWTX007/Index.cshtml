@{
    ViewBag.Title = LAWResource.報表排序設定;
    Layout = "~/Views/Shared/_LayoutMenu.cshtml";
    var ystr = DateTime.Now.Year;
}
<div id="divQueryBlock">
    <font color="blue">@LAWResource.說明<br></font>
    <font color="red">
        1.新年度第一次設定，無須按「排序年度刪除」鍵即得設定，當年度再次變動排序時，需先按「排序年度刪除」鍵後，始得重新設定排序。
    </font>
<div class="wall-title">
    <img class="index-title-icon" src="~/Content/img/search.png" />(@EP.PlatformResources.搜尋條件)
</div>
<div class="row wall">
    <div class="col-md-12 form-group detail-col">
        <div class="col-md-12">
            <label class="control-label detail-msg">@LAWResource.年度</label>
            <br />
            <select id="yy" class="form-control" style="width:35%;" name="yy">
                @while (ystr >= 2006)
                {
                    <option value="@ystr">@ystr</option>
                    ystr--;
                }
            </select>
        </div>
    </div>
    <div class="col-md-12 form-group detail-col">
        <div class="col-md-12">
            <label class="control-label detail-msg">@LAWResource.排序設定</label>
            <br />
            <select id="Sort" class="form-control" style="width:35%;" name="Sort">
                <option value="1">@LAWResource.區塊排序設定</option>
                <option value="2">@LAWResource.體系排序設定</option>
            </select>
        </div>
    </div>
    <input type="button" id="btnQuery" class="btn btn-default" value="@EP.PlatformResources.確定" data-bind="click: QueryClick" />
    <input type="button" id="btnDelete" class="btn btn-danger" value="@LAWResource.排序年度 @EP.PlatformResources.刪除" data-bind="click: DeleteClick" />
</div>
</div>
<script>
    var ViewModel = {
        QueryClick: function () {
            if ($("#Sort").val() == 1) {
                location.href = '@Url.Action("UpdateVM", "LAWTX007", new { area = "LAW" })' + "?yy=" + $("#yy").val();
            }
            else {
                location.href = '@Url.Action("UpdateSM", "LAWTX007", new { area = "LAW" })' + "?yy=" + $("#yy").val();
            }
        },
        DeleteClick: function () {
            ConfirmDelete($("#yy").val());
        }
    }
    $(document).ready(function () {
        ko.applyBindings(ViewModel);
    });

    function ConfirmDelete(yy) {
            var result = confirm('@EP.PlatformResources.確定刪除?');
            if (result) {
                DeleteData(yy);
            }
    }
    function DeleteData(yy) {
            $.ajax({
                method: "POST",
                cache: false,
                url: '@Url.Action("Delete", "LAWTX007", new { area = "LAW" })',
                data: { yy: yy },
                complete: function (data) {
                    alert("@LAWResource.刪除排序年度後");
                },
                error: function (ex) {
                    if (ex.statusText == "OK") {
                    } else {
                        appendMessage("@EP.PlatformResources.系統發生錯誤");
                    }
                }
            });
    }
</script>